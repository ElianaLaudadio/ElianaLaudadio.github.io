<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Goals & Progress</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root {
  --bg:#f5f4f2;
  --fg:#111;
  --card:#fff;
  --border:#111;
  --hover:#ece9e6;
  --maroon:#550000;
}

body {
  font-family: Inter, sans-serif;
  background: var(--bg);
  margin: 0;
  padding: 80px 20px 40px;
  color: var(--fg);
}

section {
  background: var(--card);
  padding: 24px;
  border-radius: 12px;
  margin-bottom: 30px;
  box-shadow: 0 4px 20px rgba(0,0,0,.05);
}

h2 { margin-top: 0; }

label { display:block; margin-top:10px; }

input {
  width:100%;
  padding:10px;
  margin-top:5px;
  border:1px solid var(--border);
  border-radius:6px;
  font-size:16px;
}

button {
  margin-top:12px;
  padding:10px;
  border:none;
  border-radius:6px;
  background:var(--hover);
  font-weight:600;
  cursor:pointer;
}

.progress-circle {
  width:140px;
  height:140px;
  border-radius:50%;
  margin:20px auto;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  font-size:22px;
  font-weight:600;
  background:conic-gradient(var(--hover) 0%, var(--hover) 100%);
}

.progress-circle span {
  font-size:14px;
  margin-top:6px;
}

canvas {
  width:100%!important;
  height:300px!important;
}

.message {
  text-align:center;
  font-weight:600;
  color:var(--maroon);
}
</style>
</head>

<body>

<section>
  <h2>Weight Tracking</h2>
  <input type="number" id="weight-input" placeholder="Today's weight">
  <button onclick="addWeight()">Add Entry</button>
  <button onclick="deleteLastEntry()">Delete Last Entry</button>
  <canvas id="weightChart"></canvas>
</section>

<section>
  <h2>Daily Nutrition</h2>

  <label>Protein (g)</label>
  <input type="number" id="protein" oninput="calculateProgress()">

  <label>Carbs (g)</label>
  <input type="number" id="carbs" oninput="calculateProgress()">

  <label>Fat (g)</label>
  <input type="number" id="fat" oninput="calculateProgress()">

  <div class="progress-circle" id="proteinCircle">
    <div id="proteinText">0%</div>
    <span>Protein</span>
  </div>
  <div class="message" id="proteinMessage"></div>

  <div class="progress-circle" id="calorieCircle">
    <div id="calorieText">0%</div>
    <span>Calories</span>
  </div>
  <div class="message" id="calorieMessage"></div>

  <div class="message" id="totalCalories">Total Calories: 0</div>
</section>

<audio id="celebrationSound" src="https://assets.mixkit.co/sfx/preview/mixkit-small-group-cheer-and-applause-518.mp3"></audio>

<script>
let weightData = JSON.parse(localStorage.getItem('weightEntries') || '[]');
const ctx = document.getElementById('weightChart').getContext('2d');

const chart = new Chart(ctx,{
  type:'line',
  data:{
    labels:weightData.map(e=>e.date),
    datasets:[{
      data:weightData.map(e=>e.weight),
      borderColor:'#550000',
      backgroundColor:'rgba(85,0,0,0.15)',
      fill:true,
      tension:.3,
      pointRadius:6,
      pointBackgroundColor:'#550000'
    }]
  }
});

function addWeight(){
  const w=document.getElementById('weight-input').value;
  if(!w)return;
  weightData.push({date:new Date().toLocaleDateString(),weight:w});
  localStorage.setItem('weightEntries',JSON.stringify(weightData));
  chart.data.labels.push(weightData.at(-1).date);
  chart.data.datasets[0].data.push(w);
  chart.update();
}

function deleteLastEntry(){
  weightData.pop();
  localStorage.setItem('weightEntries',JSON.stringify(weightData));
  chart.data.labels.pop();
  chart.data.datasets[0].data.pop();
  chart.update();
}

let proteinConfetti=false, calorieConfetti=false;

function calculateProgress(){
  const p=+protein.value||0, c=+carbs.value||0, f=+fat.value||0;
  const calories=p*4+c*4+f*9;
  totalCalories.textContent=`Total Calories: ${calories}`;

  const pPct=Math.min(100,p/150*100);
  proteinText.textContent=Math.round(pPct)+'%';
  proteinCircle.style.background=`conic-gradient(var(--maroon) ${pPct}%, var(--hover) ${pPct}%)`;

  const cPct=Math.min(100,calories/2000*100);
  calorieText.textContent=Math.round(cPct)+'%';
  calorieCircle.style.background=`conic-gradient(var(--maroon) ${cPct}%, var(--hover) ${cPct}%)`;

  if(pPct>=100&&!proteinConfetti){confetti();proteinConfetti=true;}
  if(cPct>=100&&!calorieConfetti){confetti();calorieConfetti=true;}
}
</script>

</body>
</html>
